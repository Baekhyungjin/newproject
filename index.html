<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct AI Media App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .glass-card { background: rgba(15, 23, 42, 0.68); backdrop-filter: blur(18px); }
        .status-box { transition: opacity 0.2s ease; }
    </style>
</head>
<body class="bg-slate-950 text-white">
    <div class="min-h-screen flex flex-col">
        <header class="bg-gradient-to-br from-indigo-600 via-blue-600 to-slate-900">
            <div class="max-w-6xl mx-auto px-6 py-16 text-center">
                <p class="uppercase tracking-[0.35em] text-indigo-200 text-sm mb-4">Direct AI Media Flow</p>
                <h1 class="text-4xl md:text-5xl font-bold mb-6">프롬프트에서 SORA2 영상까지 한 번에</h1>
                <p class="text-base md:text-lg text-indigo-100 leading-relaxed max-w-3xl mx-auto">
                    아이디어를 입력하고 프롬프트를 다듬은 뒤, 즉시 이미지와 SORA2 영상을 생성하는 단일 파이프라인을 제공합니다.
                    아래 세 단계만으로 교회 사역에 필요한 비주얼 자료를 완성해보세요.
                </p>
            </div>
        </header>

        <main class="flex-1">
            <section class="py-16">
                <div class="max-w-6xl mx-auto px-6">
                    <div class="grid gap-8 lg:grid-cols-3">
                        <!-- Step 1: Prompt Builder -->
                        <div class="glass-card border border-slate-700 rounded-3xl p-6 flex flex-col">
                            <div class="flex items-center gap-3 mb-6">
                                <span class="h-10 w-10 rounded-full bg-indigo-500 flex items-center justify-center font-semibold">1</span>
                                <div>
                                    <h2 class="text-xl font-semibold">프롬프트 생성</h2>
                                    <p class="text-slate-300 text-sm">아이디어에 맞는 스타일과 무드를 선택해보세요.</p>
                                </div>
                            </div>

                            <label for="baseIdea" class="text-sm text-slate-300 mb-2">기본 아이디어</label>
                            <textarea id="baseIdea" rows="3" class="w-full rounded-2xl bg-slate-900/70 border border-slate-700 px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4" placeholder="예: 청년 예배 홍보를 위한 모던한 포스터"></textarea>

                            <div class="grid grid-cols-2 gap-3 mb-4 text-sm">
                                <div>
                                    <label for="stylePreset" class="block text-slate-300 mb-1">스타일</label>
                                    <select id="stylePreset" class="w-full rounded-xl bg-slate-900/70 border border-slate-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                        <option value="hyper-realistic digital painting">하이퍼 리얼 디지털 페인팅</option>
                                        <option value="cinematic concept art">시네마틱 콘셉트 아트</option>
                                        <option value="studio photography">스튜디오 사진</option>
                                        <option value="watercolor illustration">수채화 일러스트</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="moodPreset" class="block text-slate-300 mb-1">무드</label>
                                    <select id="moodPreset" class="w-full rounded-xl bg-slate-900/70 border border-slate-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                        <option value="warm and hopeful">따뜻하고 희망적인</option>
                                        <option value="dynamic and energetic">역동적이고 에너지 넘치는</option>
                                        <option value="calm and reverent">차분하고 경건한</option>
                                        <option value="festive and joyful">축제 같고 즐거운</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="cameraPreset" class="block text-slate-300 mb-1">카메라/연출</label>
                                    <select id="cameraPreset" class="w-full rounded-xl bg-slate-900/70 border border-slate-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                        <option value="wide angle lens, soft rim lighting">광각 렌즈, 부드러운 림라이팅</option>
                                        <option value="50mm lens, shallow depth of field">50mm 렌즈, 얕은 심도</option>
                                        <option value="top-down view, volumetric light">탑뷰, 볼류메트릭 라이트</option>
                                        <option value="steadycam shot, golden hour">스테디캠, 골든 아워</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="ratioPreset" class="block text-slate-300 mb-1">화면비</label>
                                    <select id="ratioPreset" class="w-full rounded-xl bg-slate-900/70 border border-slate-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                        <option value="--ar 16:9">16:9 (와이드)</option>
                                        <option value="--ar 1:1">1:1 (정사각)</option>
                                        <option value="--ar 9:16">9:16 (세로)</option>
                                        <option value="--ar 21:9">21:9 (시네마)</option>
                                    </select>
                                </div>
                            </div>

                            <label for="extraKeywords" class="text-sm text-slate-300 mb-2">추가 키워드 (콤마로 구분)</label>
                            <input id="extraKeywords" type="text" class="w-full rounded-2xl bg-slate-900/70 border border-slate-700 px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4" placeholder="예: joyful worship, modern typography, glowing lights">

                            <label for="promptOutput" class="text-sm text-slate-300 mb-2">생성된 프롬프트</label>
                            <textarea id="promptOutput" rows="5" class="w-full rounded-2xl bg-slate-900/70 border border-slate-700 px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4" placeholder="버튼을 눌러 프롬프트를 생성하세요."></textarea>

                            <button id="promptBtn" onclick="generatePrompt()" class="mt-auto bg-indigo-500 hover:bg-indigo-400 transition-colors text-sm font-semibold rounded-xl px-4 py-3">
                                프롬프트 생성
                            </button>
                            <div id="promptStatus" class="status-box text-sm text-slate-300 mt-3"></div>
                        </div>

                        <!-- Step 2: Image Generator -->
                        <div class="glass-card border border-slate-700 rounded-3xl p-6 flex flex-col">
                            <div class="flex items-center gap-3 mb-6">
                                <span class="h-10 w-10 rounded-full bg-emerald-500 flex items-center justify-center font-semibold">2</span>
                                <div>
                                    <h2 class="text-xl font-semibold">이미지 생성</h2>
                                    <p class="text-slate-300 text-sm">생성된 프롬프트로 미리보기를 업데이트합니다.</p>
                                </div>
                            </div>

                            <div class="aspect-video rounded-2xl overflow-hidden border border-slate-700 bg-slate-900/60 mb-4 flex items-center justify-center">
                                <img id="imagePreview" src="https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?auto=format&fit=crop&w=900&q=80" alt="AI 이미지 미리보기" class="w-full h-full object-cover">
                            </div>
                            <p class="text-xs text-slate-400 mb-4">운영 환경에서는 실제 이미지 생성 API 응답을 연결하세요.</p>

                            <button id="imageBtn" onclick="generateImage()" class="bg-emerald-500 hover:bg-emerald-400 transition-colors text-sm font-semibold rounded-xl px-4 py-3 flex items-center justify-center gap-2">
                                <span id="imageSpinner" class="hidden h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>
                                이미지 생성 실행
                            </button>
                            <div id="imageStatus" class="status-box text-sm text-slate-300 mt-3"></div>
                        </div>

                        <!-- Step 3: Video Generator -->
                        <div class="glass-card border border-slate-700 rounded-3xl p-6 flex flex-col">
                            <div class="flex items-center gap-3 mb-6">
                                <span class="h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center font-semibold">3</span>
                                <div>
                                    <h2 class="text-xl font-semibold">SORA2 영상 생성</h2>
                                    <p class="text-slate-300 text-sm">최종 프롬프트로 SORA2 영상 변환을 요청하세요.</p>
                                </div>
                            </div>

                            <label for="videoPromptInput" class="text-sm text-slate-300 mb-2">영상 프롬프트</label>
                            <textarea id="videoPromptInput" rows="4" class="w-full rounded-2xl bg-slate-900/70 border border-slate-700 px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4" placeholder="이미지 프롬프트를 기반으로 자동 입력되며 수정할 수 있습니다."></textarea>

                            <div class="aspect-video rounded-2xl overflow-hidden border border-slate-700 bg-slate-900/60 mb-4 flex items-center justify-center">
                                <video id="videoPreview" class="w-full h-full" controls poster="https://images.unsplash.com/photo-1489515217757-5fd1be406fef?auto=format&fit=crop&w=900&q=80">
                                    <source src="https://samplelib.com/lib/preview/mp4/sample-5s.mp4" type="video/mp4">
                                    브라우저가 비디오 태그를 지원하지 않습니다.
                                </video>
                            </div>
                            <p class="text-xs text-slate-400 mb-4">SORA2 API 연결 시 변환된 영상 URL을 표시합니다.</p>

                            <button id="videoBtn" onclick="generateVideo()" class="bg-blue-500 hover:bg-blue-400 transition-colors text-sm font-semibold rounded-xl px-4 py-3 flex items-center justify-center gap-2">
                                <span id="videoSpinner" class="hidden h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>
                                영상 생성 요청
                            </button>
                            <div id="videoStatus" class="status-box text-sm text-slate-300 mt-3"></div>
                        </div>
                    </div>

                    <div class="mt-12 grid gap-6 md:grid-cols-3 text-sm text-slate-200">
                        <div class="glass-card border border-slate-800 rounded-3xl p-6">
                            <h3 class="font-semibold text-indigo-300 mb-2">API 연결 가이드</h3>
                            <p>백엔드에서 프롬프트, 이미지, 영상 변환에 대한 REST 엔드포인트를 제공한 뒤 아래 <code class="bg-slate-900/70 px-1 rounded">API_ENDPOINTS</code> 값을 수정하세요.</p>
                        </div>
                        <div class="glass-card border border-slate-800 rounded-3xl p-6">
                            <h3 class="font-semibold text-indigo-300 mb-2">워크플로우 자동화</h3>
                            <p>각 단계는 완료 시 다음 입력 필드에 자동으로 반영되며, 상태 메시지와 로딩 스피너로 진행 상황을 안내합니다.</p>
                        </div>
                        <div class="glass-card border border-slate-800 rounded-3xl p-6">
                            <h3 class="font-semibold text-indigo-300 mb-2">협업 확장</h3>
                            <p>생성된 결과를 Notion, Slack 등 협업 도구와 연동하거나 히스토리 로그를 저장하도록 확장할 수 있습니다.</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="border-t border-slate-800 py-6 text-sm text-slate-400 text-center bg-slate-950/80">
            Direct AI Media App · Mock integration ready for prompt → image → SORA2 video workflows
        </footer>
    </div>

    <script>
        const API_ENDPOINTS = {
            prompt: '/api/prompts',
            image: '/api/images',
            video: '/api/videos'
        };

        const USE_MOCK_API = true;

        function setStatus(step, message, type = 'info') {
            const el = document.getElementById(`${step}Status`);
            if (!el) return;
            const baseClasses = 'status-box mt-3 text-sm rounded-xl px-3 py-2 border';
            const classMap = {
                info: 'bg-slate-900/60 border-slate-700 text-slate-200',
                success: 'bg-emerald-500/20 border-emerald-400 text-emerald-100',
                error: 'bg-red-500/20 border-red-400 text-red-100'
            };
            el.className = `${baseClasses} ${classMap[type] || classMap.info}`;
            el.textContent = message;
        }

        function toggleLoading(step, isLoading) {
            const button = document.getElementById(`${step}Btn`);
            const spinner = document.getElementById(`${step}Spinner`);
            if (button) {
                button.disabled = isLoading;
                button.classList.toggle('opacity-60', isLoading);
                button.classList.toggle('cursor-not-allowed', isLoading);
            }
            if (spinner) {
                spinner.classList.toggle('hidden', !isLoading);
            }
        }

        async function requestAPI(type, payload) {
            if (!USE_MOCK_API) {
                const response = await fetch(API_ENDPOINTS[type], {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorMessage = await response.text();
                    throw new Error(errorMessage || `${type} API 호출 중 오류가 발생했습니다.`);
                }

                return response.json();
            }

            await new Promise(resolve => setTimeout(resolve, 1200));
            if (type === 'image') {
                return {
                    imageUrl: `https://images.unsplash.com/photo-1463107971871-fbac9ddb920f?auto=format&fit=crop&w=900&q=80&t=${Date.now()}`
                };
            }
            if (type === 'video') {
                return {
                    videoUrl: 'https://samplelib.com/lib/preview/mp4/sample-5s.mp4'
                };
            }
            if (type === 'prompt') {
                return { prompt: payload?.prompt || '' };
            }
            throw new Error('지원되지 않는 API 타입입니다.');
        }

        function generatePrompt() {
            const idea = document.getElementById('baseIdea').value.trim();
            if (!idea) {
                setStatus('prompt', '먼저 기본 아이디어를 입력해주세요.', 'error');
                return;
            }

            const style = document.getElementById('stylePreset').value;
            const mood = document.getElementById('moodPreset').value;
            const camera = document.getElementById('cameraPreset').value;
            const ratio = document.getElementById('ratioPreset').value;
            const extra = document.getElementById('extraKeywords').value.trim();

            let prompt = `${style}, ${mood} mood, ${camera}, ${ratio}. ${idea}`;
            if (extra) {
                prompt += `. Keywords: ${extra}`;
            }

            document.getElementById('promptOutput').value = prompt;
            document.getElementById('videoPromptInput').value = prompt;
            setStatus('prompt', '프롬프트가 생성되었습니다. 이미지 생성 버튼을 눌러 다음 단계로 진행하세요.', 'success');
        }

        async function generateImage() {
            const prompt = document.getElementById('promptOutput').value.trim();
            if (!prompt) {
                setStatus('image', '프롬프트를 먼저 생성하거나 직접 입력해주세요.', 'error');
                return;
            }

            toggleLoading('image', true);
            setStatus('image', '이미지를 생성하는 중입니다. 잠시만 기다려주세요…', 'info');
            try {
                const { imageUrl } = await requestAPI('image', { prompt });
                if (imageUrl) {
                    document.getElementById('imagePreview').src = imageUrl;
                    setStatus('image', '이미지가 생성되었습니다. 영상 생성 단계로 넘어갈 수 있습니다.', 'success');
                    document.getElementById('videoPromptInput').value = prompt;
                } else {
                    throw new Error('이미지 URL이 반환되지 않았습니다.');
                }
            } catch (error) {
                setStatus('image', error.message || '이미지 생성 중 문제가 발생했습니다.', 'error');
            } finally {
                toggleLoading('image', false);
            }
        }

        async function generateVideo() {
            const prompt = document.getElementById('videoPromptInput').value.trim();
            if (!prompt) {
                setStatus('video', '영상 프롬프트가 비어 있습니다. 프롬프트를 확인해주세요.', 'error');
                return;
            }

            toggleLoading('video', true);
            setStatus('video', 'SORA2 영상 생성을 요청했습니다. 처리 완료까지 기다려주세요…', 'info');
            try {
                const { videoUrl } = await requestAPI('video', { prompt });
                if (videoUrl) {
                    const videoEl = document.getElementById('videoPreview');
                    videoEl.src = videoUrl;
                    videoEl.load();
                    setStatus('video', '영상이 준비되었습니다. 재생 버튼을 눌러 확인하세요.', 'success');
                } else {
                    throw new Error('영상 URL이 반환되지 않았습니다.');
                }
            } catch (error) {
                setStatus('video', error.message || '영상 생성 중 문제가 발생했습니다.', 'error');
            } finally {
                toggleLoading('video', false);
            }
        }
    </script>
</body>
</html>
